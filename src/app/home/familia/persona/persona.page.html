<ion-header>
  <ion-toolbar>
    <ion-title>Personas</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-card-header color='primary'>
    <ion-toolbar color='primary' class="ion-text-center">
      <ion-title>PERSONAS</ion-title>
      <ion-fab-button type='button' slot='end' size='small' (click)='refresh()' color='success'>
        <ion-icon name='refresh-outline'>
        </ion-icon>
      </ion-fab-button>
    </ion-toolbar>
    <ion-toolbar color='primary' (click)='volverFamilias()' class="ion-text-end">
      <ion-label>
        <ion-icon name="arrow-back-outline" slot='start'></ion-icon>
        Volver a Familias
      </ion-label>
    </ion-toolbar>
    <ion-row color='primary'>
      <ion-col size=8>
        FAMILIA DE: {{ familia?.ApellidoPaterno}} {{ familia?.ApellidoMaterno}} {{ familia?.Nombres}}
      </ion-col>
      <ion-col size=4>
        DNI TITULAR: {{ familia?.DNI }}
      </ion-col>
    </ion-row>

  </ion-card-header>
  <ion-card-content>
    <ion-item>
      <ion-searchbar placeholder='Ingrese valor a buscar:' type='text' (keyup)='filtrar($event)'></ion-searchbar>
      <ion-fab-button class="hidden-sm-up" type='button' slot='end' size='small' (click)='add()'>
        <ion-icon name='add'>
        </ion-icon>
      </ion-fab-button>

      <ion-button class="hidden-xs-down" type='button' slot='end' size='default' (click)='add()'>
        <ion-icon name='add'>
        </ion-icon>
        <ion-label> Agregar</ion-label>
      </ion-button>
    </ion-item>

    <ngx-datatable class="material" [rows]="personas" [columnMode]="'force'" [headerHeight]="50" [footerHeight]="50"
      [rowHeight]="50" [scrollbarV]="true" [scrollbarH]="true" #myTable>

      <ngx-datatable-row-detail [rowHeight]="490">
        <ng-template let-row="row" let-expanded="expanded" ngx-datatable-row-detail-template>
          <div class="card-familia">
            <ion-row>
              <ion-col>
                <ion-label position='stacked'>Fecha y Hora Entrevista</ion-label>
                <ion-input type='text' disabled>
                  {{ row.FechaEntrevista | date : 'dd/MM/yyyy HH:mm:ss' }}
                </ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>DNI</ion-label>
                <ion-input type='number' disabled>{{ row.DNI}}</ion-input>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'>Nombres y Apellidos</ion-label>
                <ion-input type='text' disabled>{{ row.ApellidoPaterno}} {{ row.ApellidoMaterno}} {{ row.Nombres }}
                </ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>Género</ion-label>
                <ion-input type='text' disabled>{{ row.Genero }}</ion-input>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'>Fecha de Nacimiento</ion-label>
                <ion-input type='text' disabled>{{ row.FechaNacimiento | date : 'dd/MM/yyyy' }}
                </ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>Edad durante la entrevista</ion-label>
                <ion-input type='text' disabled>{{ row.Edad }}</ion-input>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'>Dirección</ion-label>
                <ion-input type='text' disabled>{{ row.Direccion}}, {{ row.CentroPoblado }} -
                  {{row. Distrito}}
                </ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>Teléfono</ion-label>
                <ion-input type='text' disabled>{{ row.Telefono }}</ion-input>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'>Ocupación</ion-label>
                <ion-input type='text' disabled>{{ row.Ocupacion }}</ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>Nivel de Instrucción</ion-label>
                <ion-input type='text' disabled>{{ row.NivelInstruccion}}</ion-input>
              </ion-col>
            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'>Ingresos Económicos</ion-label>
                <ion-input type='text' disabled>{{ row.IngresosEconomicos}}</ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>Situación Económica</ion-label>
                <ion-input type='text' disabled>{{ row.SituacionEconomica}}</ion-input>
              </ion-col>

            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'> Programas Sociales</ion-label>
                <ion-input type='text' disabled>{{ row.ProgramaSocial}}</ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>Servicios Médicos</ion-label>
                <ion-input type='text' disabled>{{ row.ServiciosMedicos}}</ion-input>
              </ion-col>

            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'> Frecuencia de Atención</ion-label>
                <ion-input type='text' disabled>{{ row.FrecuenciaAtencion}}</ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'> Codigo Hogar</ion-label>
                <ion-input type='text' disabled>{{ row.CodigoHogar}}</ion-input>
              </ion-col>

            </ion-row>

            <ion-row>
              <ion-col>
                <ion-label position='stacked'> Vínculo Familiar</ion-label>
                <ion-input type='text' disabled>{{ row.VinculoFamiliar}}</ion-input>
              </ion-col>
              <ion-col>
                <ion-label position='stacked'>Entrevistador</ion-label>
                <ion-input type='text' disabled>{{ row.NombreEntrevistador}}</ion-input>
              </ion-col>

            </ion-row>
          </div>
        </ng-template>
      </ngx-datatable-row-detail>



      <ngx-datatable-column name='DNI' prop="DNI" [frozenLeft]="true" [width]="100">
        <ng-template let-row='row' ngx-datatable-cell-template>
          <ion-note color='primary' (click)='detallePersona(row)'>
            {{ row.DNI }}
          </ion-note>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name='ES TITULAR' prop="EsTitular" [width]="100">
        <ng-template let-row='row' ngx-datatable-cell-template>
          <ion-note color='success' *ngIf='row.EsTitular'> SI </ion-note>
          <ion-note color='danger' *ngIf='!row.EsTitular'> NO </ion-note>
        </ng-template>
      </ngx-datatable-column>
      <ngx-datatable-column name='VÍNCULO FAMILIAR' prop="VinculoFamiliar">
      </ngx-datatable-column>
      <ngx-datatable-column name='AP. PATERNO' prop="ApellidoPaterno">
      </ngx-datatable-column>
      <ngx-datatable-column name='AP. MATERNO' prop="ApellidoMaterno">
      </ngx-datatable-column>
      <ngx-datatable-column name='NOMBRES' prop="Nombres">
      </ngx-datatable-column>
      <ngx-datatable-column name='ACCIONES' [sortable]='false' [width]="150">

        <ng-template let-row='row' ngx-datatable-cell-template>

          <ion-button (click)='triaje(row)' size='small' color='primary'>
            <ion-icon name="git-branch-outline"></ion-icon>
          </ion-button>

          <ion-button (click)='mod(row)' size='small' color='success'>
            <ion-icon name='pencil'></ion-icon>
          </ion-button>
          <ion-button *ngIf='!row.EsTitular' (click)='delPersona(row)' size='small' color='danger'>
            <ion-icon name='trash'></ion-icon>
          </ion-button>
          <!-- <ion-button *ngIf='row.EsTitular' (click)='delPersona(row)' size='small' color='success'>
            <ion-icon name='trash'></ion-icon>
          </ion-button> -->


        </ng-template>
      </ngx-datatable-column>
    </ngx-datatable>

  </ion-card-content>
</ion-content>